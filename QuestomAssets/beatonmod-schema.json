{
	"$schema": "http://json-schema.org/draft-07/schema",
	"$id": "beatonmod",
	"$comment": "The BeatOn Mod Schema",
	"title": "BeatOn Mod",
	"type": "object",
	"properties": {
		"id": {
			"title": "ID",
			"description": "The ID of the mod, NO SPACES!",
			"type": "string"
		},
		"name": {
			"title": "Name",
			"description": "The name of the mod",
			"type": "string"
		},
		"porter": {
			"title": "Porter",
			"description": "The name of the person who ported the mod to Quest",
			"type": "string"
		},
		"author": {
			"title": "Author",
			"description": "The author of the mod",
			"type": "string"
		},
		"description": {
			"title": "Description",
			"description": "The description of the mod. Each line is separated by a newline",
			"type": "array",
			"items": {
				"type": "string"
			}
		},
		"category": {
			"title": "Category",
			"description": "The category of the mod",
			"type": "string",
			"enum": [
				"Saber",
				"Gameplay",
				"Library",
				"Note",
				"Other"
			]
		},
		"config": {
			"title": "Config",
			"description": "The config for the mod",
			"type": "object"
		},
		"ui": {
			"title": "UI",
			"description": "The UI to use for each config key",
			"type": "object",
			"additionalProperties": {
				"type": "object",
				"properties": {
					"uiType": {
						"title": "UI Type",
						"description": "The UI type to display for this key",
						"type": "string",
						"enum": [
							"radial",
							"select",
							"multiselect",
							"color-picker",
							"input",
							"hidden"
						]
					}
				}
			}
		},
		"gameVersion": {
			"title": "Beat Saber Version",
			"description": "The Beat Saber Version for the mod",
			"type": "string"
		},
		"version": {
			"title": "Version",
			"description": "The version of the mod (3 DIGITS!)",
			"type": "string",
			"pattern": "^\\d+.\\d+.\\d+$"
		},
		"links": {
			"description": "Links of the mod",
			"type": "object",
			"properties": {
				"project-home": {
					"type": "string"
				}
			}
		},
		"platform": {
			"type": "string",
			"enum": [
				"Quest"
			]
		},
		"coverImageFilename": {
			"description": "The cover image's filename",
			"type": "string"
		},
		"icon": {
			"title": "Icon",
			"description": "The cover image's filename",
			"type":  "string"
		},
		"components": {
			"title": "Components",
			"description": "Components of the mod",
			"type": "array",
			"items": {
				"type": "object",
				"properties": {
					"Type": {
						"title": "Type",
						"description": "The type of the mod component",
						"enum": [
							"AssetsMod",
							"HookMod"
						]
					}
				},
				"if": {
					"properties": {
						"Type": {
							"enum": [ "AssetsMod" ]
						}
					},
					"required": [ "Type" ]
				},
				"then": {
					"properties": {
						"InstallAction": {
							"allOf": [
								{
									"$ref": "https://raw.githubusercontent.com/sc2ad/QuestStopgap/json_fix/QuestomAssets/AssetsActionSchema.json"
								},
								{
									"properties": {
										"Actions": {
											"items": {
												"properties": {
													"Type": {
														"enum": [
															"ReplaceAsset",
															"CreateAsset",
															"RemoveAsset"
														]
													}
												},
												"anyOf": [
													{
														"properties": {
															"Type": {
																"enum": [ "ReplaceAsset" ]
															}
														},
														"required": [
															"Type",
															"StepNumber",
															"Locator",
															"FromDataFile"
														]
													},
													{
														"properties": {
															"Type": {
																"enum": [ "CreateAsset" ]
															}
														},
														"not": {
															"properties": {
																"AssetType": {
																	"enum": [
																		"Component",
																		"Unknown"
																	]
																}
															}
														},
														"required": [
															"Type",
															"StepNumber",
															"FromDataFile",
															"FileName",
															"AssetType"
														]
													},
													{
														"properties": {
															"Type": {
																"enum": [ "CreateAsset" ]
															},
															"AssetType": {
																"enum": [
																	"Component",
																	"Unknown"
																]
															}
														},
														"required": [
															"Type",
															"StepNumber",
															"FromDataFile",
															"FileName",
															"AssetType",
															"ClassID"
														]
													},
													{
														"properties": {
															"Type": {
																"enum": [ "MonoBehaviour" ]
															}
														},
														"required": [
															"Type",
															"StepNumber",
															"FromDataFile",
															"FileName",
															"AssetType",
															"ClassID"
														]
													}
												]
											}
										}
									}
								}
							]							
						},
						"UninstallAction": {
							"allOf": [
								{
									"$ref": "https://raw.githubusercontent.com/sc2ad/QuestStopgap/json_fix/QuestomAssets/AssetsActionSchema.json"
								},
								{
									"properties": {
										"Actions": {
											"items": {
												"anyOf": [
													{
														"properties": {
															"Type": {
																"enum": [
																	"RestoreAsset"
																]
															}
														},
														"allOf": [
															{
																"required": [
																	"Type",
																	"StepNumber",
																	"Locator"
																]
															},
															{
																"not": {
																	"required": [
																		"FromDataFile",
																		"AllowOverwriteName",
																		"ClassID",
																		"AssetType",
																		"FileName"
																	]
																}
															}
														]
													},
													{
														"properties": {
															"Type": {
																"enum": [
																	"RemoveAsset"
																]
															}
														},
														"allOf": [
															{
																"required": [
																	"Type",
																	"StepNumber",
																	"Locator",
																	"FileName"
																]
															},
															{
																"not": {
																	"required": [
																		"FromDataFile",
																		"AllowOverwriteName",
																		"AssetType",
																		"ClassID"
																	]
																}
															}
														]
													}
												]
											}
										}
									}
								}
							]
						}
					}
				},
				"else": {
					"if": {
						"properties": {
							"Type": {
								"enum": [ "HookMod" ]
							}
						},
						"required": [ "Type" ]
					},
					"then": {
						"properties": {
							"InstallAction": {
								"allOf": [
									{
										"$ref": "https://raw.githubusercontent.com/sc2ad/QuestStopgap/json_fix/QuestomAssets/HookActionSchema.json"
									},
									{
										"required": [
											"InstallLibraryFile"
										]
									}
								]
							},
							"UninstallAction": {
								"allOf": [
									{
										"$ref": "https://raw.githubusercontent.com/sc2ad/QuestStopgap/json_fix/QuestomAssets/HookActionSchema.json"
									},
									{
										"required": [
											"RemoveLibraryFile"
										]
									}
								]
							}
						}
					}
				},
				"required": [
					"Type",
					"InstallAction",
					"UninstallAction"
				]
			}
		}
	},
	"required": [
		"id",
		"name",
		"author",
		"description",
		"category",
		"gameVersion",
		"version",
		"platform",
		"links",
		"components"
	],
	"additionalProperties": false
}